# Home System - Machine

rg_fallen_machine = {
	usage = fallen_empire_init
	name = 芬里尔III
	class = "rl_standard_stars"

	flags = {
		lcluster
		lcluster4
		ring_world_built
	}

	planet = {
		class = star
		orbit_distance = 0
		orbit_angle = 0
	}

	change_orbit = 45

	planet = {
		class = "pc_ringworld_tech"
		name = 外环
		orbit_angle = -30
		orbit_distance = 0
	}

	planet = {
		class = "pc_ringworld_seam"
		name = 泡芙碗
		orbit_angle = 30
		orbit_distance = 0
	}

	planet = {
		class = "pc_ringworld_habitable"
		name = 菠萝包工厂
		orbit_angle = 30
		orbit_distance = 0
		deposit_blockers = none
		modifiers = none

		init_effect = {

			create_cluster = {
				id = fe_mach_cluster
				radius = 80
				center = this.solar_system
			}

			rg_create_fallen_empire_species_effect = yes
			rg_create_fallen_empire_country_effect = yes

			set_planet_flag = fallen_empire_world
			prevent_anomaly = yes
			set_owner = event_target:rg_scion_fe
			set_controller = event_target:rg_scion_fe
			set_capital = yes

			add_building = building_ancient_control_center
			add_building = building_nourishment_center
			add_building = building_nourishment_center
			add_building = building_nourishment_center
			add_building = building_nourishment_center
			add_building = building_ancient_palace
			add_building = building_affluence_center
			add_building = building_affluence_center
			add_building = building_affluence_center
			add_building = building_affluence_center
			add_building = building_dimensional_fabricator
			add_building = building_dimensional_fabricator

			while = {
				count = 5
				add_district = district_rw_science
			}
			while = {
				count = 5
				add_district = district_rw_nexus
			}
			while = {
				count = 105
				create_pop = {
					species = owner_main_species
				}
			}

			while = {
				count = 94
				create_pop = {
					species = event_target:rg_scion_slave.species
				}
			}

			rg_create_fallen_empire_starting_navy = yes

			while = {
				count = 40
				create_army = {
					name = random
					owner = event_target:rg_scion_fe
					type = "gray_army"
				}
			}
		}
	}

	init_effect = {
		spawn_megastructure = {
			type = "ring_world_ruined"
			orbit_angle = -90
			orbit_distance = 45
		}
		# rg_create_fe_citadel = yes
	}

	planet = {
		class = "pc_ringworld_tech"
		name = 中环
		orbit_angle = 30
		orbit_distance = 0
	}

	planet = {
		class = "pc_ringworld_seam"
		name = 烤面包机
		orbit_angle = 30
		orbit_distance = 0
	}

	planet = {
		class = "pc_ringworld_habitable"
		name = 可颂工厂
		orbit_angle = 30
		orbit_distance = 0
		deposit_blockers = none
		modifiers = none

		init_effect = {

			set_planet_flag = fallen_empire_world
			prevent_anomaly = yes
			set_owner = event_target:rg_scion_fe

			add_building = building_ancient_control_center
			add_building = building_dimensional_fabricator
			add_building = building_dimensional_fabricator
			add_building = building_dimensional_fabricator
			add_building = building_dimensional_fabricator
			add_building = building_dimensional_fabricator
			add_building = building_nano_forge
			add_building = building_nano_forge
			add_building = building_nano_forge
			add_building = building_nano_forge
			add_building = building_nano_forge

			while = {
				count = 5
				add_district = district_rw_nexus
			}
			while = {
				count = 50
				create_pop = {
					species = owner_main_species
				}
			}
			while = {
				count = 20
				create_pop = {
					species = event_target:rg_scion_slave.species
				}
			}
			while = {
				count = 20
				create_army = {
					name = random
					owner = event_target:rg_scion_fe
					type = "gray_army"
				}
			}
		}
	}

	planet = {
		class = "pc_ringworld_tech"
		name = 内环
		orbit_angle = 30
		orbit_distance = 0
	}

	planet = {
		class = "pc_ringworld_seam"
		name = 奶油核心
		orbit_angle = 30
		orbit_distance = 0
	}

	planet = {
		class = "pc_ringworld_habitable"
		name = 糖霜工厂
		orbit_angle = 30
		orbit_distance = 0
		deposit_blockers = none
		modifiers = none

		init_effect = {
			set_planet_flag = fallen_empire_world
			prevent_anomaly = yes
			set_owner = event_target:rg_scion_fe

			add_building = building_ancient_control_center
			add_building = building_class_4_singularity
			add_building = building_class_4_singularity
			add_building = building_class_4_singularity
			add_building = building_class_4_singularity
			add_building = building_nano_forge
			add_building = building_nano_forge
			add_building = building_nano_forge
			add_building = building_nano_forge
			add_building = building_nano_forge
			add_building = building_nano_forge

			while = {
				count = 5
				add_district = district_rw_generator
			}
			while = {
				count = 22
				create_pop = {
					species = owner_main_species
				}
			}
			while = {
				count = 10
				create_pop = {
					species = event_target:rg_scion_slave.species
				}
			}
			while = {
				count = 10
				create_army = {
					name = random
					owner = event_target:rg_scion_fe
					type = "gray_army"
				}
			}
		}
	}

	# spawn_megastructure = {
	# 	type = lgate_base
	# 	orbit_angle = 225
	# 	orbit_distance = 30
	# }
}

